# üìÑ –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ —Ä–æ–±–æ—Ç–∏ –∑ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –≤ TechNest

## ‚úÖ –©–û –í–ò–ü–†–ê–í–õ–ï–ù–û

–ü—Ä–æ–±–ª–µ–º–∞: AI –ø–æ–º—ñ—á–Ω–∏–∫ –Ω–µ –º—ñ–≥ —á–∏—Ç–∞—Ç–∏ —Ç–µ–∫—Å—Ç –∑ PDF –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤, –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–µ–∫—Å—Ç –Ω–µ –≤–∏—Ç—è–≥—É–≤–∞–≤—Å—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ.

### –í–∏–∫–æ–Ω–∞–Ω—ñ –∑–º—ñ–Ω–∏:

1. ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ `pdf-parse` –¥–æ –≤–µ—Ä—Å—ñ—ó 2.x –∑ –ø–æ–∫—Ä–∞—â–µ–Ω–æ—é –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é PDF
2. ‚úÖ –î–æ–¥–∞–Ω–æ `pdfjs-dist` —Ç–∞ `pdf2json` –¥–ª—è –∫—Ä–∞—â–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ
3. ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ –ø–æ–∫—Ä–∞—â–µ–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é `extractTextFromPDF()` –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º PDFParse v2 API
4. ‚úÖ –î–æ–¥–∞–Ω–æ –ø–æ—Å—Ç—ñ–π–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —É –ø–∞–ø—Ü—ñ `/documents/`
5. ‚úÖ –î–æ–¥–∞–Ω–æ –Ω–æ–≤—ñ API endpoints –¥–ª—è –ø–µ—Ä–µ–æ–±—Ä–æ–±–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
6. ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–æ AI —á–∞—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –∞–∫—Ç–∏–≤—ñ–≤

---

## üîß –ù–û–í–Ü API ENDPOINTS

### 1. –ü–µ—Ä–µ–æ–±—Ä–æ–±–∏—Ç–∏ –æ–∫—Ä–µ–º–∏–π –¥–æ–∫—É–º–µ–Ω—Ç
```
POST /api/documents/:documentId/reprocess
Authorization: Bearer <token>
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "ok": true,
  "message": "–î–æ–∫—É–º–µ–Ω—Ç –ø–µ—Ä–µ–æ–±—Ä–æ–±–µ–Ω–æ",
  "hasText": true,
  "textLength": 1523
}
```

### 2. –ü–µ—Ä–µ–æ–±—Ä–æ–±–∏—Ç–∏ –≤—Å—ñ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
```
POST /api/documents/reprocess-all
Authorization: Bearer <token>
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "ok": true,
  "total": 5,
  "processed": 5,
  "withText": 4,
  "errors": 0,
  "message": "–ü–µ—Ä–µ–æ–±—Ä–æ–±–∞–Ω–æ 5 –∑ 5 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤. –¢–µ–∫—Å—Ç –≤–∏—Ç—è–≥–Ω—É—Ç–æ –∑ 4."
}
```

---

## üìã –Ø–ö –í–ò–ö–û–†–ò–°–¢–û–í–£–í–ê–¢–ò

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ü–µ—Ä–µ–æ–±—Ä–æ–±–∫–∞ —á–µ—Ä–µ–∑ API (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

–í–∏–∫–ª–∏—á—Ç–µ API endpoint –¥–ª—è –ø–µ—Ä–µ–æ–±—Ä–æ–±–∫–∏ —ñ—Å–Ω—É—é—á–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤:

```bash
# –û—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó (–∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à)
TOKEN="–≤–∞—à_jwt_token"

# –ü–µ—Ä–µ–æ–±—Ä–æ–±—ñ—Ç—å –≤—Å—ñ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∏
curl -X POST https://technest-backend.onrender.com/api/documents/reprocess-all \
  -H "Authorization: Bearer $TOKEN"
```

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∏–π —Å–∫—Ä–∏–ø—Ç (—è–∫—â–æ –º–∞—î—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)

```bash
cd /opt/render/project/src
node reprocess-pdfs.js
```

---

## üéØ –ü–ï–†–ï–í–Ü–†–ö–ê –†–û–ë–û–¢–ò

### 1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –≤–∏—Ç—è–≥–Ω—É–≤—Å—è —Ç–µ–∫—Å—Ç

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ debug endpoint:
```bash
curl https://technest-backend.onrender.com/api/debug/docs \
  -H "Authorization: Bearer $TOKEN"
```

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ–ª–µ `text` —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ - –≤–æ–Ω–æ –º–∞—î –º—ñ—Å—Ç–∏—Ç–∏ –≤–∏—Ç—è–≥–Ω—É—Ç–∏–π —Ç–µ–∫—Å—Ç.

### 2. –ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ AI —á–∞—Ç

–¢–µ–ø–µ—Ä AI –∑–º–æ–∂–µ —á–∏—Ç–∞—Ç–∏ –≤–∞—à—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏! –ó–∞–ø–∏—Ç–∞–π—Ç–µ:

```json
{
  "message": "–†–æ–∑–∫–∞–∂–∏ –ø—Ä–æ —Ç–µ—Ö–Ω—ñ—á–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤",
  "assetId": "PC-001"  // –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ - –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–∫—Ç–∏–≤—É
}
```

**–ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–∏—Ç—É:**
```bash
curl -X POST https://technest-backend.onrender.com/api/ai/chat \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "–Ø–∫—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ —É –º–µ–Ω–µ —î —Ç–∞ –ø—Ä–æ —â–æ –≤ –Ω–∏—Ö –π–¥–µ—Ç—å—Å—è?"
  }'
```

---

## üîç –î–Ü–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú

### –Ø–∫—â–æ —Ç–µ–∫—Å—Ç –Ω–µ –≤–∏—Ç—è–≥—É—î—Ç—å—Å—è:

1. **PDF —î —Å–∫–∞–Ω–æ–≤–∞–Ω–∏–º –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º** - –ø–æ—Ç—Ä—ñ–±–µ–Ω OCR (—Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É)
   - –†—ñ—à–µ–Ω–Ω—è: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ñ PDF –∞–±–æ –¥–æ–¥–∞–π—Ç–µ OCR –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É

2. **PDF –ø–æ—à–∫–æ–¥–∂–µ–Ω–∏–π**
   - –†—ñ—à–µ–Ω–Ω—è: –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç

3. **–§–∞–π–ª –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ**
   - –†—ñ—à–µ–Ω–Ω—è: –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ –º–æ–±—ñ–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫

### –õ–æ–≥–∏ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

–ü—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ PDF –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:
```
[PDF] –ü–æ—á–∞—Ç–æ–∫ –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –∑: /path/to/file.pdf
[PDF] ‚úÖ –£—Å–ø—ñ—à–Ω–æ –≤–∏—Ç—è–≥–Ω—É—Ç–æ 1523 —Å–∏–º–≤–æ–ª—ñ–≤
[PDF] –°—Ç–æ—Ä—ñ–Ω–æ–∫: 3
```

–Ø–∫—â–æ —î –ø–æ–º–∏–ª–∫–∞:
```
[PDF] ‚ö†Ô∏è –¢–µ–∫—Å—Ç –∑–∞–Ω–∞–¥—Ç–æ –∫–æ—Ä–æ—Ç–∫–∏–π –∞–±–æ –ø–æ—Ä–æ–∂–Ω—ñ–π
[PDF] ‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏—Ç—è–≥–Ω—É—Ç–∏ —Ç–µ–∫—Å—Ç
```

---

## üöÄ –ü–û–ö–†–ê–©–ï–ù–ù–Ø –í –ú–ê–ô–ë–£–¢–ù–¨–û–ú–£

### –ú–æ–∂–ª–∏–≤—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:

1. **OCR –¥–ª—è —Å–∫–∞–Ω–æ–≤–∞–Ω–∏—Ö PDF**
   ```bash
   npm install tesseract.js
   ```

2. **–í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å –∑ PDF**
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `getTable()` –∑ pdf-parse v2

3. **–í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å**
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `getImage()` –∑ pdf-parse v2

4. **–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –º—ñ–Ω—ñ–∞—Ç—é—Ä —Å—Ç–æ—Ä—ñ–Ω–æ–∫**
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `getScreenshot()` –∑ pdf-parse v2

---

## üìä –¢–ï–•–ù–Ü–ß–ù–Ü –î–ï–¢–ê–õ–Ü

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤:

```
technest-backend/
‚îú‚îÄ‚îÄ documents/                    # –ü–æ—Å—Ç—ñ–π–Ω–µ —Å—Ö–æ–≤–∏—â–µ —Ñ–∞–π–ª—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ 1765219017646-3-PC-004-manual.pdf
‚îÇ   ‚îî‚îÄ‚îÄ 1765219023012-3-PC-007-guide.pdf
‚îú‚îÄ‚îÄ uploads/                      # –¢–∏–º—á–∞—Å–æ–≤—ñ —Ñ–∞–π–ª–∏ (—ñ–≥–Ω–æ—Ä—É—î—Ç—å—Å—è git)
```

### –§–æ—Ä–º–∞—Ç —ñ–º–µ–Ω—ñ —Ñ–∞–π–ª—É:
```
{timestamp}-{userId}-{assetId}-{originalName}
```

### –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö:

–ú–æ–¥–µ–ª—å `AssetDocument`:
```prisma
model AssetDocument {
  id        Int      @id @default(autoincrement())
  userId    Int
  assetId   String
  fileName  String
  mimeType  String
  filePath  String?   // ‚úÖ –ù–æ–≤–æ–µ –ø–æ–ª–µ
  fileSize  Int?      // ‚úÖ –ù–æ–≤–æ–µ –ø–æ–ª–µ
  text      String?   @db.Text  // –í–∏—Ç—è–≥–Ω—É—Ç–∏–π —Ç–µ–∫—Å—Ç
  createdAt DateTime @default(now())

  @@index([userId])
  @@index([assetId])
}
```

---

## ‚ú® –ü–Ü–î–°–£–ú–û–ö

**–©–æ —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—î:**
- ‚úÖ AI —á–∏—Ç–∞—î —Ç–µ–∫—Å—Ç –∑ PDF –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
- ‚úÖ –§–∞–π–ª–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø–æ—Å—Ç—ñ–π–Ω–æ
- ‚úÖ –ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–æ–±—Ä–æ–±–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏
- ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:**
1. –ü–µ—Ä–µ–æ–±—Ä–æ–±—ñ—Ç—å —ñ—Å–Ω—É—é—á—ñ PDF —á–µ—Ä–µ–∑ API endpoint
2. –ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ AI —á–∞—Ç –∑ –≤–∞—à–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
3. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–æ–≤—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ - –≤–æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç—å—Å—è

**–ü–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞?**
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ `/api/debug/docs` –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- –°—Ç–≤–æ—Ä—ñ—Ç—å issue —è–∫—â–æ –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è

---

–°—Ç–≤–æ—Ä–µ–Ω–æ: 2025-12-08
–í–µ—Ä—Å—ñ—è: 2.0
