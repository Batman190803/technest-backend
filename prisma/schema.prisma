generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  id           Int      @id @default(autoincrement())
  username     String   @unique
  passwordHash String
  role         String   @default("user")
  createdAt    DateTime @default(now())

  // 2FA
  twoFactorEnabled Boolean @default(false)
  twoFactorSecret  String? // base32 секрет для TOTP

  categories     AssetCategory[]
  assetSnapshot  AssetSnapshot?
}


model AssetCategory {
  id      Int      @id @default(autoincrement())
  title   String
  user    User     @relation(fields: [userId], references: [id])
  userId  Int

  assets  Asset[]
}

model Asset {
  id              Int      @id @default(autoincrement())
  name            String
  inventoryNumber String
  model           String?
  serialNumber    String?
  status          String?
  room            String?
  responsible     String?
  phone           String?
  groupName       String?
  comments        String?
  qrCode          String?   @unique

  category   AssetCategory @relation(fields: [categoryId], references: [id])
  categoryId Int

  createdAt  DateTime @default(now())
}
model AssetSnapshot {
  id        Int      @id @default(autoincrement())
  userId    Int      @unique
  user      User     @relation(fields: [userId], references: [id])
  data      String   // JSON з assetCategories
  updatedAt DateTime @updatedAt
}
